<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-i18n="pageTitle">المحلل المصمم | مصممة واجهات ويب ومُدخلة بيانات</title>
    
    
<script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&family=Inter:wght@400;600;700&display=swap');
        
        /* تعريف اللون الوردي الغامق الجديد (Pink 600) الذي سيستخدم كـ Accent */
        :root {
            --accent-color: #db2777; /* Tailwind Pink 600 for a deep, vibrant pink */
        }

        body {
            /* الخلفية الوردية الفاتحة والباردة (Rose-50) */
            font-family: 'Cairo', 'Inter', sans-serif;
            background-color: #fff1f2; /* Rose 50 - وردي فاتح جداً وبارد */
            color: #1f2937; /* لون النص الأساسي داكن */
        }
        
        /* تغيير لون عناصر شريط التنقل والتذييل لتناسب الخلفية الفاتحة */
        header, footer {
            background-color: #ffffff; /* خلفية بيضاء لشريط التنقل */
            border-bottom: 1px solid #fecaca; /* حدود وردية فاتحة */
            color: #1f2937; /* نص داكن */
        }
        
        /* تأثير نظيف للروابط النشطة والأزرار */
        .active-link {
            /* لون خلفية خفيف لتمييز الرابط النشط (باستخدام شفافية Pink 600) */
            background-color: rgba(219, 39, 119, 0.1) !important; 
            color: var(--accent-color) !important; 
            /* إضافة خط سفلي بسيط بدلاً من التوهج */
            border-bottom: 2px solid var(--accent-color) !important; 
            font-weight: 700 !important;
            pointer-events: none; 
        }

        /* تنسيق الأزرار الأساسي */
        .cta-button {
            transition: all 0.2s ease;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1); /* ظل أخف للخلفية الفاتحة */
        }

        .cta-button:hover:not(:disabled) {
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
            transform: translateY(-1px);
        }

        /* إعادة ضبط padding-bottom للسماح بظهور التذييل */
        main {
            padding-bottom: 5rem; 
        }

        /* تأثير الحركة على أيقونات التواصل الاجتماعي */
        .social-icon {
            transition: transform 0.3s ease-in-out, color 0.3s ease-in-out;
            color: #4b5563; /* لون أساسي رمادي داكن */
        }

        .social-icon:hover {
            transform: scale(1.2); /* تكبير الأيقونة */
            color: var(--accent-color); /* تغيير لون الأيقونة إلى الوردي الغامق عند التمرير */
        }
        
        /* تنسيق الأقسام الداخلية (Skills, Contact) لتناسب الخلفية الفاتحة */
        .bg-card {
            background-color: #ffffff; /* خلفية بيضاء للبطاقات */
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.05), 0 4px 6px -2px rgba(0, 0, 0, 0.02);
            border: 1px solid #fce7f3; /* إطار وردي فاتح جداً */
        }

        /* تعديل ألوان الإدخال والنص في نموذج الاتصال */
        .form-input {
             background-color: #fce7f6; /* خلفية وردية فاتحة جداً للإدخال */
             color: #1f2937; /* نص داكن داخل الإدخال */
             border: 1px solid #fecaca;
        }
        .form-input:focus {
            border-color: #db2777; /* Pink 600 */
            box-shadow: 0 0 0 1px #db2777; /* Pink 600 */
        }
    </style>
</head>
<body class="min-h-screen">

    
<!-- شريط التنقل العلوي (Fixed Navbar) -->
<header class="fixed top-0 right-0 left-0 bg-white border-b border-pink-300/50 shadow-md z-10 h-24">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 h-full">
            <div class="flex items-center justify-between h-full py-2">
                
<!-- جزء الشعار واسم التطبيق -->
<div class="flex items-center space-x-3 space-x-reverse h-full">
                    <!-- الشعار المضاف مع حجم أكبر (h-16) -->
                    <img src="https://i.ibb.co/My1jcDx0/Modern-Abstract-W-Letter-Free-Logo-removebg-preview.png" 
                         alt="شعار المحلل المصمم" 
                         class="h-16 w-auto object-contain self-center">
                    
                    <!-- اسم التطبيق بجوار الشعار - أصبح باللون الأبيض لكن تم تغييره للداكن ليتناسب مع الخلفية البيضاء، والحجم XL -->
                    <span class="text-xl font-extrabold self-center text-gray-800" 
                          data-i18n="appTitle">المحلل المصمم</span> 
                </div>
                
<nav class="flex space-x-4 space-x-reverse items-center">
                    
<a href="#about" class="nav-link text-sm font-medium text-gray-600 hover:text-pink-600 transition-all duration-200 py-2 px-4 rounded-lg hover:bg-pink-100" data-i18n="navAbout">ملخص تعريفي</a>
                    <a href="#skills" class="nav-link text-sm font-medium text-gray-600 hover:text-pink-600 transition-all duration-200 py-2 px-4 rounded-lg hover:bg-pink-100" data-i18n="navSkills">المهارات</a>
                    <a href="#contact" class="nav-link text-sm font-medium text-gray-600 hover:text-pink-600 transition-all duration-200 py-2 px-4 rounded-lg hover:bg-pink-100" data-i18n="navContact">تواصل</a>
                    
                    
<!-- زر تبديل اللغة -->
                    <button id="lang-toggle" class="cta-button bg-pink-200 hover:bg-pink-300 text-gray-800 font-medium py-2 px-4 rounded-lg text-sm transition-all duration-200">
                        English / EN
                    </button>
                </nav>
            </div>
        </div>
    </header>

    
<main class="max-w-7xl mx-auto pt-28">
        
        
<!-- قسم الملخص التعريفي (#about) -->
<section id="about" class="py-12 px-6 lg:px-20">
            <div class="text-center">
                
<img id="profile-pic" 
                    src="https://i.ibb.co/5XNMNXpm/removebg-preview.png" 
                    onerror="this.onerror=null; this.src='https://placehold.co/200x200/ffb700/000000?text=الشعار'" 
                    alt="شعار" 
                    class="w-64 h-64 rounded-full shadow-lg mx-auto mb-8 object-cover">

                <!-- تم تغيير لون العنوان إلى داكن ليناسب الخلفية الفاتحة -->
                <h2 class="text-5xl font-extrabold text-gray-800 mb-4" data-i18n="heroTitle">أهلاً بك! أنا المحلل المصمم</h2>
                
<p class="text-2xl text-pink-600 mb-10" data-i18n="heroSubtitle">مصممة واجهات ويب ومُدخلة بيانات</p>

                
<!-- تم تغيير لون النص ليتناسب مع الخلفية الفاتحة -->
<div class="max-w-4xl mx-auto text-lg text-gray-700 text-right space-y-6">
                    <p id="profile-summary-p1" data-i18n="summaryP1">
                        مصممة واجهات ويب، أقوم بتحويل البيانات المعقدة إلى تجارب مستخدم بسيطة وفعالة، مما يضمن أن تكون النماذج والواجهات ليست فقط جميلة بل دقيقة وسهلة الاستخدام.
                    </p>
                    <p id="profile-summary-p2" data-i18n="summaryP2">
                        أركز على بناء واجهات إدخال ديناميكية وسريعة الاستجابة مع تطبيق قواعد تَحَقُّقٍ صارمة من صحة البيانات (Validation) لضمان أعلى مستويات الجودة في المعلومات المدخلة.
                    </p>
                </div>

            </div>
        </section>

        
<!-- قسم المهارات (#skills) -->
<section id="skills" class="py-12 px-6 lg:px-20 hidden">
            
<h2 class="text-4xl font-bold text-pink-600 mb-12 text-center border-b-2 border-pink-400/50 pb-4" data-i18n="skillsTitle">المهارات التقنية</h2>
            
            
<div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
                
<!-- بطاقة المهارة 1 -->
<div class="bg-card p-6 rounded-xl border border-pink-300/50">
                    <h3 class="text-2xl font-semibold mb-4 text-gray-800" data-i18n="skillH1"><i class="fas fa-code text-pink-600 ml-2"></i> تصميم وتطوير الواجهات</h3>
                    <ul class="text-gray-600 space-y-3 list-disc pr-5" id="skill-list-frontend">
                        <li data-i18n="skill1_1">تصميم واجهات المستخدم وتجربة المستخدم (UI/UX) باستخدام Figma.</li>
                        <li data-i18n="skill1_2">تطوير الوظائف التفاعلية باستخدام JavaScript ومكتبة React.</li>
                        <li data-i18n="skill1_3">ضمان التوافق الكامل مع جميع الأجهزة (موبايل، تابلت، حاسوب).</li>
                    </ul>
                </div>
                
                
<!-- بطاقة المهارة 2 -->
<div class="bg-card p-6 rounded-xl border border-pink-300/50">
                    <h3 class="text-2xl font-semibold mb-4 text-gray-800" data-i18n="skillH2"><i class="fas fa-database text-pink-600 ml-2"></i> إدخال ومعالجة البيانات</h3>
                    <ul class="text-gray-600 space-y-3 list-disc pr-5" id="skill-list-data">
                        <li data-i18n="skill2_1">اَلتَّحَقُّقُ من صحة البيانات مُتعدد المستويات (Validation)</li>
                        <li data-i18n="skill2_2">العمل على قواعد البيانات (SQL/NoSQL)</li>
                        <li data-i18n="skill2_3">تحليل وتصفية البيانات في Excel/Sheets</li>
                    </ul>
                </div>

                
<!-- بطاقة المهارة 3 -->
<div class="bg-card p-6 rounded-xl border border-pink-300/50">
                    <h3 class="text-2xl font-semibold mb-4 text-gray-800" data-i18n="skillH3"><i class="fas fa-check-circle text-pink-600 ml-2"></i> ضمان الجودة والاختبار</h3>
                    <ul class="text-gray-600 space-y-3 list-disc pr-5" id="skill-list-qa">
                        <li data-i18n="skill3_1">اختبار قابلية الاستخدام (Usability Testing)</li>
                        <li data-i18n="skill3_2">التأكد من سلامة وتكامل البيانات (Data Integrity)</li>
                        <li data-i18n="skill3_3">تصحيح الأخطاء واستكشاف المشكلات (Debugging)</li>
                        <li data-i18n="skill3_4">اختبار التوافق عبر المتصفحات والأجهزة (Cross-Browser)</li>
                    </ul>
                </div>
            </div>
        </section>

        
<!-- قسم التواصل (#contact) -->
<section id="contact" class="py-12 px-6 lg:px-20 hidden">
            
<h2 class="text-4xl font-bold text-pink-600 mb-12 text-center border-b-2 border-pink-400/50 pb-4" data-i18n="contactTitle">تواصل معي</h2>
            
            
<div class="max-w-xl mx-auto bg-card p-8 rounded-xl border border-pink-300/50">
                <form id="contact-form" class="space-y-6">
                    <div>
                        <label for="name" class="block text-sm font-medium text-gray-600" data-i18n="formNameLabel">الاسم الكامل</label>
                        
<input type="text" id="name" name="name" required class="form-input mt-1 block w-full rounded-md shadow-sm p-3">
                    </div>
                    <div>
                        <label for="email" class="block text-sm font-medium text-gray-600" data-i18n="formEmailLabel">البريد الإلكتروني</label>
                        
<input type="email" id="email" name="email" required class="form-input mt-1 block w-full rounded-md shadow-sm p-3">
                    </div>

                    
<div>
                        <label for="message-topic" class="block text-sm font-medium text-gray-600" data-i18n="formTopicLabel">موضوع رسالتك (للمساعدة في الصياغة)</label>
                        <div class="mt-1 flex space-x-2 space-x-reverse" id="topic-input-container">
                            
<input type="text" id="message-topic" data-i18n-placeholder="formTopicPlaceholder" placeholder="مثال: تصميم نموذج تسجيل دخول جديد" class="form-input block w-full rounded-md shadow-sm p-3">
                            
<button type="button" id="ai-draft-button" class="cta-button flex-shrink-0 bg-sky-600 hover:bg-sky-700 text-white font-bold py-3 px-4 rounded-lg text-sm disabled:opacity-50 disabled:cursor-not-allowed">
                                ✨ <span data-i18n="formDraftButton">صياغة تلقائية</span>
                            </button>
                        </div>
                        
<div id="ai-loading" class="hidden text-sm text-pink-600 mt-2">
                            <i class="fas fa-spinner fa-spin ml-1"></i> <span data-i18n="loadingDraft">جارٍ صياغة المسودة باستخدام Gemini...</span>
                        </div>
                    </div>
                    
                    <div>
                        <label for="message" class="block text-sm font-medium text-gray-600" data-i18n="formMessageLabel">الرسالة</label>
                        
<textarea id="message" name="message" rows="4" required class="form-input mt-1 block w-full rounded-md shadow-sm p-3"></textarea>
                    </div>

                    
<button type="submit" class="cta-button w-full bg-pink-600 hover:bg-pink-700 text-white font-bold py-3 px-4 rounded-lg">
                        <span data-i18n="formSubmitButton">إرسال الرسالة</span>
                    </button>
                </form>
            </div>

            
<div class="mt-12 text-center space-y-4 text-lg">
                
<p class="text-gray-600"><i class="fas fa-envelope text-pink-600 ml-2"></i> <span data-i18n="contactEmail">البريد الإلكتروني:</span> <span class="text-pink-600" dir="ltr">Bayan1325@gmail.com</span></p>
                
<p class="text-gray-600"><i class="fas fa-phone text-pink-600 ml-2"></i> <span data-i18n="contactPhone">الهاتف:</span> <span class="text-pink-600" dir="ltr">+962 7 7236 4081</span></p>
                <div class="flex justify-center space-x-6 space-x-reverse mt-6">
                    
<a href="https://www.facebook.com/profile.php?id=61583046233567" target="_blank" class="text-gray-500 hover:text-pink-600 text-3xl transition duration-300 social-icon"><i class="fab fa-facebook"></i></a>
                    <a href="https://wa.me/962772364081" target="_blank" class="text-gray-500 hover:text-pink-600 text-3xl transition duration-300 social-icon"><i class="fab fa-whatsapp"></i></a>
                    <!-- رابط الإنستغرام المحدث -->
                    <a href="https://www.instagram.com/theadvanalyst_1?igsh=amJqYXNmbThscXIw" target="_blank" class="text-gray-500 hover:text-pink-600 text-3xl transition duration-300 social-icon"><i class="fab fa-instagram"></i></a>
                </div>
            </div>
            
        </section>

    </main>

    
<footer class="bg-white border-t border-pink-300/50 py-6 text-center text-gray-500">
        <p><span data-i18n="footerCopy">جميع الحقوق محفوظة &copy;</span> <span id="current-year">2025</span>. <span data-i18n="footerAnalyst">المحلل المصمم.</span></p>
    </footer>

    
<script>
        // Constants for the Gemini API
        const API_KEY = ""; // Kept empty as per instructions
        const API_URL_BASE = "https://generativelanguage.googleapis.com/v1beta/models/";
        const MODEL_NAME = "gemini-2.5-flash-preview-09-2025";
        
        // حالة اللغة الافتراضية
        let currentLang = 'ar';
        
        // قاموس الترجمة
        const translations = {
            'ar': {
                // Meta and Navigation
                'pageTitle': 'المحلل المصمم | مصممة واجهات ويب ومُدخلة بيانات',
                'appTitle': 'المحلل المصمم',
                'navAbout': 'ملخص تعريفي',
                'navSkills': 'المهارات',
                'navContact': 'تواصل',
                'toggleButton': 'English / EN',
                // About Section
                'heroTitle': 'أهلاً بك! أنا المحلل المصمم',
                'heroSubtitle': 'مصممة واجهات ويب ومُدخلة بيانات',
                'summaryP1': 'مصممة واجهات ويب، أقوم بتحويل البيانات المعقدة إلى تجارب مستخدم بسيطة وفعالة، مما يضمن أن تكون النماذج والواجهات ليست فقط جميلة بل دقيقة وسهلة الاستخدام.',
                'summaryP2': 'أركز على بناء واجهات إدخال ديناميكية وسريعة الاستجابة مع تطبيق قواعد تَحَقُّقٍ صارمة من صحة البيانات (Validation) لضمان أعلى مستويات الجودة في المعلومات المدخلة.',
                // Skills Section
                'skillsTitle': 'المهارات التقنية',
                'skillH1': 'تصميم وتطوير الواجهات',
                'skill1_1': 'تصميم واجهات المستخدم وتجربة المستخدم (UI/UX) باستخدام Figma.',
                'skill1_2': 'تطوير الوظائف التفاعلية باستخدام JavaScript ومكتبة React.',
                'skill1_3': 'ضمان التوافق الكامل مع جميع الأجهزة (موبايل، تابلت، حاسوب).',
                'skillH2': 'إدخال ومعالجة البيانات',
                'skill2_1': 'اَلتَّحَقُّقُ من صحة البيانات مُتعدد المستويات (Validation)',
                'skill2_2': 'العمل على قواعد البيانات (SQL/NoSQL)',
                'skill2_3': 'تحليل وتصفية البيانات في Excel/Sheets',
                'skillH3': 'ضمان الجودة والاختبار',
                'skill3_1': 'اختبار قابلية الاستخدام (Usability Testing)',
                'skill3_2': 'التأكد من سلامة وتكامل البيانات (Data Integrity)',
                'skill3_3': 'تصحيح الأخطاء واستكشاف المشكلات (Debugging)',
                'skill3_4': 'اختبار التوافق عبر المتصفحات والأجهزة (Cross-Browser)',
                // Contact Section
                'contactTitle': 'تواصل معي',
                'formNameLabel': 'الاسم الكامل',
                'formEmailLabel': 'البريد الإلكتروني',
                'formTopicLabel': 'موضوع رسالتك (للمساعدة في الصياغة)',
                'formTopicPlaceholder': 'مثال: تصميم نموذج تسجيل دخول جديد',
                'formDraftButton': 'صياغة تلقائية',
                'loadingDraft': 'جارٍ صياغة المسودة باستخدام Gemini...',
                'formMessageLabel': 'الرسالة',
                'formSubmitButton': 'إرسال الرسالة',
                'contactEmail': 'البريد الإلكتروني:',
                'contactPhone': 'الهاتف:',
                // Footer
                'footerCopy': 'جميع الحقوق محفوظة &copy;',
                'footerAnalyst': 'المحلل المصمم.',
                // Error Messages (not strictly text, but useful for L10N)
                'errorFetch': 'عذراً، فشلت عملية الصياغة التلقائية. الرجاء المحاولة مرة أخرى.',
                'errorEmptyTopic': 'الرجاء إدخال موضوع الرسالة لإنشاء مسودة.',
            },
            'en': {
                // Meta and Navigation
                'pageTitle': 'The Analyst Designer | Web Interface Designer & Data Entry',
                'appTitle': 'The Analyst Designer',
                'navAbout': 'About',
                'navSkills': 'Skills',
                'navContact': 'Contact',
                'toggleButton': 'العربية / AR',
                // About Section
                'heroTitle': 'Welcome! I am The Analyst Designer',
                'heroSubtitle': 'Web Interface Designer & Data Entry Specialist',
                'summaryP1': 'Web interface designer, I transform complex data into simple and effective user experiences, ensuring that forms and interfaces are not only aesthetically pleasing but also accurate and user-friendly.',
                'summaryP2': 'I focus on building dynamic and responsive input interfaces while applying strict data validation rules to guarantee the highest quality of entered information.',
                // Skills Section
                'skillsTitle': 'Technical Skills',
                'skillH1': 'Interface Design & Development',
                'skill1_1': 'Designing User Interface and User Experience (UI/UX) using Figma.',
                'skill1_2': 'Developing interactive functions using JavaScript and the React library.',
                'skill1_3': 'Ensuring full compatibility with all devices (Mobile, Tablet, Desktop).',
                'skillH2': 'Data Entry and Processing',
                'skill2_1': 'Multi-level Data Validation.',
                'skill2_2': 'Working with Databases (SQL/NoSQL).',
                'skill2_3': 'Analyzing and filtering data in Excel/Sheets.',
                'skillH3': 'Quality Assurance & Testing',
                'skill3_1': 'Usability Testing.',
                'skill3_2': 'Ensuring Data Integrity.',
                'skill3_3': 'Debugging and Troubleshooting.',
                'skill3_4': 'Cross-Browser and Device Compatibility Testing.',
                // Contact Section
                'contactTitle': 'Contact Me',
                'formNameLabel': 'Full Name',
                'formEmailLabel': 'Email Address',
                'formTopicLabel': 'Your Message Topic (for drafting assistance)',
                'formTopicPlaceholder': 'Example: Designing a New Login Form',
                'formDraftButton': 'Auto Draft',
                'loadingDraft': 'Drafting message using Gemini...',
                'formMessageLabel': 'Message',
                'formSubmitButton': 'Send Message',
                'contactEmail': 'Email:',
                'contactPhone': 'Phone:',
                // Footer
                'footerCopy': 'All rights reserved &copy;',
                'footerAnalyst': 'The Analyst Designer.',
                // Error Messages
                'errorFetch': 'Sorry, the auto-draft process failed. Please try again.',
                'errorEmptyTopic': 'Please enter a message topic to generate a draft.',
            }
        };

        // وظيفة تحديث اللغة
        function updateLanguage(lang) {
            const isRTL = lang === 'ar';
            document.documentElement.lang = lang;
            document.documentElement.dir = isRTL ? 'rtl' : 'ltr';

            // تحديث النصوص
            document.querySelectorAll('[data-i18n]').forEach(element => {
                const key = element.getAttribute('data-i18n');
                if (translations[lang][key]) {
                    element.textContent = translations[lang][key];
                }
            });

            // تحديث placeholder
            document.querySelectorAll('[data-i18n-placeholder]').forEach(element => {
                const key = element.getAttribute('data-i18n-placeholder');
                if (translations[lang][key]) {
                    element.placeholder = translations[lang][key];
                }
            });

            // تحديث زر تبديل اللغة
            const toggleButton = document.getElementById('lang-toggle');
            toggleButton.textContent = translations[lang]['toggleButton'];
            currentLang = lang;

            // تحديث حالة الروابط النشطة
            updateActiveLink();
        }

        // وظيفة التبديل بين اللغات
        document.getElementById('lang-toggle').addEventListener('click', () => {
            const newLang = currentLang === 'ar' ? 'en' : 'ar';
            updateLanguage(newLang);
        });

        // وظيفة تفعيل الرابط النشط في شريط التنقل
        function updateActiveLink() {
            const sections = document.querySelectorAll('section');
            const navLinks = document.querySelectorAll('.nav-link');
            const headerHeight = document.querySelector('header').offsetHeight;

            sections.forEach(section => {
                if (section.id && section.id !== 'contact' && section.id !== 'skills') {
                    section.classList.remove('hidden'); // إظهار الأقسام المطلوبة لـ ScrollSpy
                }
            });

            let current = '';

            sections.forEach(section => {
                const sectionTop = section.offsetTop - headerHeight - 10;
                if (scrollY >= sectionTop) {
                    current = section.getAttribute('id');
                }
            });

            navLinks.forEach(link => {
                link.classList.remove('active-link');
                if (link.getAttribute('href').includes(current)) {
                    link.classList.add('active-link');
                }
            });
            
            // إظهار وإخفاء الأقسام بناءً على الرابط النشط
            sections.forEach(section => {
                const sectionId = section.getAttribute('id');
                if (sectionId === 'about' || sectionId === 'skills' || sectionId === 'contact') {
                    if (sectionId === current) {
                        section.classList.remove('hidden');
                    } else {
                        section.classList.add('hidden');
                    }
                }
            });
            
            // تحديث الرابط النشط عند النقر على روابط التنقل
            navLinks.forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    const targetId = this.getAttribute('href').substring(1);
                    const targetSection = document.getElementById(targetId);
                    const offsetTop = targetSection.offsetTop - headerHeight;

                    window.scrollTo({
                        top: offsetTop,
                        behavior: 'smooth'
                    });
                    
                    // تحديث الحالة النشطة على الفور
                    navLinks.forEach(l => l.classList.remove('active-link'));
                    this.classList.add('active-link');

                    // إخفاء الأقسام الأخرى عند النقر
                    sections.forEach(section => {
                        const sId = section.getAttribute('id');
                        if (sId === 'about' || sId === 'skills' || sId === 'contact') {
                             if (sId === targetId) {
                                section.classList.remove('hidden');
                            } else {
                                section.classList.add('hidden');
                            }
                        }
                    });

                });
            });

        }

        // وظيفة للتعامل مع طلب Gemini API
        async function fetchGeminiDraft(topic, language) {
            const apiUrl = `${API_URL_BASE}${MODEL_NAME}:generateContent?key=${API_KEY}`;
            
            const systemPrompt = language === 'ar' ? 
                `أنت مساعد صياغة رسائل مهنية. مهمتك هي كتابة مسودة رسالة بريد إلكتروني مهنية تتضمن تحية قصيرة، والغرض من الرسالة بناءً على الموضوع المقدم، وعبارة ختامية مهذبة. يجب أن تكون المسودة باللغة العربية الفصحى. لا تضمن أي معلومات اتصال أو اسم في الرسالة.` :
                `You are a professional message drafting assistant. Your task is to write a draft of a professional email message including a brief greeting, the purpose of the message based on the provided topic, and a polite closing statement. The draft must be in standard English. Do not include any contact information or names in the message.`;

            const userQuery = language === 'ar' ? 
                `موضوع الرسالة: ${topic}. اكتب مسودة الرسالة الآن.` : 
                `Message topic: ${topic}. Write the message draft now.`;

            const payload = {
                contents: [{ parts: [{ text: userQuery }] }],
                systemInstruction: { parts: [{ text: systemPrompt }] },
            };

            const maxRetries = 3;
            let response = null;
            
            for (let i = 0; i < maxRetries; i++) {
                try {
                    response = await fetch(apiUrl, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    });

                    if (response.ok) {
                        break; // الخروج من الحلقة في حال نجاح الاستجابة
                    }
                } catch (error) {
                    console.error('Fetch error during retry:', error);
                }
                
                if (i < maxRetries - 1) {
                    const delay = Math.pow(2, i) * 1000; // تأخير 1s, 2s, 4s
                    await new Promise(resolve => setTimeout(resolve, delay));
                }
            }
            
            if (!response || !response.ok) {
                return { error: translations[language]['errorFetch'] };
            }

            const result = await response.json();
            const text = result.candidates?.[0]?.content?.parts?.[0]?.text;

            return { text };
        }

        // وظيفة التعامل مع زر "صياغة تلقائية"
        async function handleAiDraft() {
            const topicInput = document.getElementById('message-topic');
            const messageTextarea = document.getElementById('message');
            const loadingIndicator = document.getElementById('ai-loading');
            const draftButton = document.getElementById('ai-draft-button');
            const topic = topicInput.value.trim();

            if (!topic) {
                alert(translations[currentLang]['errorEmptyTopic']); // استخدام alert هنا لتسهيل المثال، يفضل تبديلها بـ Modal
                return;
            }

            // تعطيل الزر وإظهار مؤشر التحميل
            draftButton.disabled = true;
            loadingIndicator.classList.remove('hidden');

            const { text, error } = await fetchGeminiDraft(topic, currentLang);

            // تمكين الزر وإخفاء مؤشر التحميل
            draftButton.disabled = false;
            loadingIndicator.classList.add('hidden');

            if (error) {
                alert(error); // استخدام alert هنا لتسهيل المثال، يفضل تبديلها بـ Modal
            } else if (text) {
                // إلحاق المسودة في بداية حقل الرسالة
                messageTextarea.value = text + '\n\n---\n\n' + messageTextarea.value;
                messageTextarea.focus();
            }
        }

        // تهيئة الصفحة عند التحميل
        window.onload = function() {
            // تحديد السنة الحالية في التذييل
            document.getElementById('current-year').textContent = new Date().getFullYear();

            // تطبيق اللغة الافتراضية (العربية)
            updateLanguage('ar');

            // تفعيل وظيفة التمرير Spy
            updateActiveLink(); // التحديث الأولي
            window.addEventListener('scroll', updateActiveLink);
            
            // ربط زر الصياغة التلقائية
            document.getElementById('ai-draft-button').addEventListener('click', handleAiDraft);

            // منع إرسال النموذج فعلياً (لأننا لا نملك backend)
            document.getElementById('contact-form').addEventListener('submit', function(e) {
                e.preventDefault();
                alert(currentLang === 'ar' ? 'تم استلام رسالتك بنجاح! (في تطبيق حقيقي، سيتم إرسال الرسالة الآن عبر خادم).' : 'Your message has been received successfully! (In a real application, the message would now be sent via a server).');
            });

             // التأكد من تطبيق حالة نشطة فور التحميل
             const aboutLink = document.querySelector('.nav-link[href="#about"]');
             if (aboutLink) aboutLink.classList.add('active-link');
        };
    </script>
</body>
</html>
