<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-i18n="pageTitle">المحلل المصمم | مصممة واجهات ويب ومُدخلة بيانات</title>
    
    
<script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&family=Inter:wght@400;600;700&display=swap');
        
        /* تعريف اللون الوردي الغامق الجديد (Pink 600: #db2777) الذي سيستخدم كـ Accent */
        :root {
            --accent-color: #db2777; /* Tailwind Pink 600 for a deep, vibrant pink matching the logo */
        }

        body {
            /* الخلفية الوردية الفاتحة والباردة (Rose-50) */
            font-family: 'Cairo', 'Inter', sans-serif;
            background-color: #fff1f2; /* Rose 50 - وردي فاتح جداً وبارد */
            color: #1f2937; /* لون النص الأساسي داكن */
        }
        
        /* تغيير لون عناصر شريط التنقل والتذييل لتناسب الخلفية الفاتحة */
        header, footer {
            background-color: #ffffff; /* خلفية بيضاء لشريط التنقل */
            border-bottom: 1px solid #fecaca; /* حدود وردية فاتحة */
            color: #1f2937; /* نص داكن */
        }
        
        /* تأثير نظيف للروابط النشطة والأزرار */
        .active-link {
            /* لون خلفية خفيف لتمييز الرابط النشط (باستخدام شفافية Pink 600) */
            background-color: rgba(219, 39, 119, 0.1) !important; 
            color: var(--accent-color) !important; 
            /* إضافة خط سفلي بسيط بدلاً من التوهج */
            border-bottom: 2px solid var(--accent-color) !important; 
            font-weight: 700 !important;
            pointer-events: none; 
        }

        /* تنسيق الأزرار الأساسي */
        .cta-button {
            transition: all 0.2s ease;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1); /* ظل أخف للخلفية الفاتحة */
        }

        .cta-button:hover:not(:disabled) {
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
            transform: translateY(-1px);
        }

        /* إعادة ضبط padding-bottom للسماح بظهور التذييل */
        main {
            padding-bottom: 5rem; 
        }

        /* تأثير الحركة على أيقونات التواصل الاجتماعي */
        .social-icon {
            transition: transform 0.3s ease-in-out, color 0.3s ease-in-out;
            color: #4b5563; /* لون أساسي رمادي داكن */
        }

        .social-icon:hover {
            transform: scale(1.2); /* تكبير الأيقونة */
            color: var(--accent-color); /* تغيير لون الأيقونة إلى الوردي الغامق عند التمرير */
        }
        
        /* تنسيق الأقسام الداخلية (Skills, Contact) لتناسب الخلفية الفاتحة */
        .bg-card {
            background-color: #ffffff; /* خلفية بيضاء للبطاقات */
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.05), 0 4px 6px -2px rgba(0, 0, 0, 0.02);
            border: 1px solid #fecaca; /* إطار وردي فاتح */
        }

        /* تعديل ألوان الإدخال والنص في نموذج الاتصال */
        .form-input {
             background-color: #fce7f6; /* خلفية وردية فاتحة جداً للإدخال */
             color: #1f2937; /* نص داكن داخل الإدخال */
             border: 1px solid #fecaca;
        }
        .form-input:focus {
            border-color: #db2777; /* Pink 600 */
            box-shadow: 0 0 0 1px #db2777; /* Pink 600 */
        }
    </style>
</head>
<body class="min-h-screen">

    
<!-- شريط التنقل العلوي (Fixed Navbar) -->
<header class="fixed top-0 right-0 left-0 bg-white border-b border-pink-300/50 shadow-md z-10 h-24">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 h-full">
            <div class="flex items-center justify-between h-full py-2">
                
<!-- جزء الشعار واسم التطبيق -->
<div class="flex items-center space-x-3 space-x-reverse h-full">
                    <!-- الشعار المضاف مع حجم أكبر (h-16) -->
                    <img src="https://i.ibb.co/My1jcDx0/Modern-Abstract-W-Letter-Free-Logo-removebg-preview.png" 
                         alt="شعار المحلل المصمم" 
                         class="h-16 w-auto object-contain self-center">
                    
                    <!-- اسم التطبيق بجوار الشعار - اللون أصبح داكناً ليتناسب مع الخلفية البيضاء، والحجم XL -->
                    <span class="text-xl font-extrabold self-center text-gray-800" 
                          data-i18n="appTitle">المحلل المصمم</span> 
                </div>
                
<nav class="flex space-x-4 space-x-reverse items-center">
                    
<a href="#about" class="nav-link text-sm font-medium text-gray-600 hover:text-pink-600 transition-all duration-200 py-2 px-4 rounded-lg hover:bg-pink-100" data-i18n="navAbout">ملخص تعريفي</a>
                    <a href="#skills" class="nav-link text-sm font-medium text-gray-600 hover:text-pink-600 transition-all duration-200 py-2 px-4 rounded-lg hover:bg-pink-100" data-i18n="navSkills">المهارات</a>
                    <a href="#contact" class="nav-link text-sm font-medium text-gray-600 hover:text-pink-600 transition-all duration-200 py-2 px-4 rounded-lg hover:bg-pink-100" data-i18n="navContact">تواصل</a>
                    
                    
<!-- زر تبديل اللغة -->
                    <button id="lang-toggle" class="cta-button bg-pink-200 hover:bg-pink-300 text-gray-800 font-medium py-2 px-4 rounded-lg text-sm transition-all duration-200">
                        English / EN
                    </button>
                </nav>
            </div>
        </div>
    </header>

    
<main class="max-w-7xl mx-auto pt-28">
        
        
<!-- قسم الملخص التعريفي (#about) -->
<section id="about" class="py-12 px-6 lg:px-20 min-h-screen">
            <div class="text-center">
                
<img id="profile-pic" 
                    src="https://i.ibb.co/5XNMNXpm/removebg-preview.png" 
                    onerror="this.onerror=null; this.src='https://placehold.co/200x200/ffb700/000000?text=الشعار'" 
                    alt="شعار" 
                    class="w-64 h-64 rounded-full shadow-lg mx-auto mb-8 object-cover">

                <!-- تم تغيير لون العنوان إلى داكن ليناسب الخلفية الفاتحة -->
                <h2 class="text-5xl font-extrabold text-gray-800 mb-4" data-i18n="heroTitle">أهلاً بك! أنا المحلل المصمم</h2>
                
<p class="text-2xl text-pink-600 mb-10" data-i18n="heroSubtitle">مصممة واجهات ويب ومُدخلة بيانات</p>

                
<!-- تم تغيير لون النص ليتناسب مع الخلفية الفاتحة -->
<div class="max-w-4xl mx-auto text-lg text-gray-700 text-right space-y-6">
                    <p id="profile-summary-p1" data-i18n="summaryP1">
                        مصممة واجهات ويب، أقوم بتحويل البيانات المعقدة إلى تجارب مستخدم بسيطة وفعالة، مما يضمن أن تكون النماذج والواجهات ليست فقط جميلة بل دقيقة وسهلة الاستخدام.
                    </p>
                    <p id="profile-summary-p2" data-i18n="summaryP2">
                        أركز على بناء واجهات إدخال ديناميكية وسريعة الاستجابة مع تطبيق قواعد تَحَقُّقٍ صارمة من صحة البيانات (Validation) لضمان أعلى مستويات الجودة في المعلومات المدخلة.
                    </p>
                </div>

            </div>
        </section>

        
<!-- قسم المهارات (#skills) -->
<section id="skills" class="py-12 px-6 lg:px-20 min-h-screen hidden">
            
<h2 class="text-4xl font-bold text-pink-600 mb-12 text-center border-b-2 border-pink-400/50 pb-4" data-i18n="skillsTitle">المهارات التقنية</h2>
            
            
<div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
                
<!-- بطاقة المهارة 1 -->
<div class="bg-card p-6 rounded-xl border border-pink-300/50">
                    <h3 class="text-2xl font-semibold mb-4 text-gray-800" data-i18n="skillH1"><i class="fas fa-code text-pink-600 ml-2"></i> تصميم وتطوير الواجهات</h3>
                    <ul class="text-gray-600 space-y-3 list-disc pr-5" id="skill-list-frontend">
                        <li data-i18n="skill1_1">تصميم واجهات المستخدم وتجربة المستخدم (UI/UX) باستخدام Figma.</li>
                        <li data-i18n="skill1_2">تطوير الوظائف التفاعلية باستخدام JavaScript ومكتبة React.</li>
                        <li data-i18n="skill1_3">ضمان التوافق الكامل مع جميع الأجهزة (موبايل، تابلت، حاسوب).</li>
                    </ul>
                </div>
                
                
<!-- بطاقة المهارة 2 -->
<div class="bg-card p-6 rounded-xl border border-pink-300/50">
                    <h3 class="text-2xl font-semibold mb-4 text-gray-800" data-i18n="skillH2"><i class="fas fa-database text-pink-600 ml-2"></i> إدخال ومعالجة البيانات</h3>
                    <ul class="text-gray-600 space-y-3 list-disc pr-5" id="skill-list-data">
                        <li data-i18n="skill2_1">اَلتَّحَقُّقُ من صحة البيانات مُتعدد المستويات (Validation)</li>
                        <li data-i18n="skill2_2">العمل على قواعد البيانات (SQL/NoSQL)</li>
                        <li data-i18n="skill2_3">تحليل وتصفية البيانات في Excel/Sheets</li>
                    </ul>
                </div>

                
<!-- بطاقة المهارة 3 -->
<div class="bg-card p-6 rounded-xl border border-pink-300/50">
                    <h3 class="text-2xl font-semibold mb-4 text-gray-800" data-i18n="skillH3"><i class="fas fa-check-circle text-pink-600 ml-2"></i> ضمان الجودة والاختبار</h3>
                    <ul class="text-gray-600 space-y-3 list-disc pr-5" id="skill-list-qa">
                        <li data-i18n="skill3_1">اختبار قابلية الاستخدام (Usability Testing)</li>
                        <li data-i18n="skill3_2">التأكد من سلامة وتكامل البيانات (Data Integrity)</li>
                        <li data-i18n="skill3_3">تصحيح الأخطاء واستكشاف المشكلات (Debugging)</li>
                        <li data-i18n="skill3_4">اختبار التوافق عبر المتصفحات والأجهزة (Cross-Browser)</li>
                    </ul>
                </div>
            </div>
        </section>

        
<!-- قسم التواصل (#contact) -->
<section id="contact" class="py-12 px-6 lg:px-20 min-h-screen hidden">
            
<h2 class="text-4xl font-bold text-pink-600 mb-12 text-center border-b-2 border-pink-400/50 pb-4" data-i18n="contactTitle">تواصل معي</h2>
            
            
<!-- نموذج الاتصال -->
<div class="max-w-xl mx-auto bg-card p-8 rounded-xl">
                <form id="contact-form" class="space-y-6">
                    <div>
                        <label for="name" class="block text-sm font-medium text-gray-700" data-i18n="formNameLabel">الاسم الكامل</label>
                        
<input type="text" id="name" name="name" required class="form-input mt-1 block w-full rounded-md shadow-sm p-3 focus:ring-pink-600 focus:border-pink-600">
                    </div>
                    <div>
                        <label for="email" class="block text-sm font-medium text-gray-700" data-i18n="formEmailLabel">البريد الإلكتروني</label>
                        
<input type="email" id="email" name="email" required class="form-input mt-1 block w-full rounded-md shadow-sm p-3 focus:ring-pink-600 focus:border-pink-600">
                    </div>

                    
<div>
                        <label for="message-topic" class="block text-sm font-medium text-gray-700" data-i18n="formTopicLabel">موضوع رسالتك (للمساعدة في الصياغة)</label>
                        <div class="mt-1 flex space-x-2 space-x-reverse" id="topic-input-container">
                            
<input type="text" id="message-topic" data-i18n-placeholder="formTopicPlaceholder" placeholder="مثال: تصميم نموذج تسجيل دخول جديد" class="form-input block w-full rounded-md shadow-sm p-3 focus:ring-pink-600 focus:border-pink-600">
                            
<!-- زر الصياغة التلقائية -->
<button type="button" id="ai-draft-button" class="cta-button flex-shrink-0 bg-sky-600 hover:bg-sky-700 text-white font-bold py-3 px-4 rounded-lg text-sm disabled:opacity-50 disabled:cursor-not-allowed">
                                ✨ <span data-i18n="formDraftButton">صياغة تلقائية</span>
                            </button>
                        </div>
                        
<div id="ai-loading" class="hidden text-sm text-pink-600 mt-2">
                            <i class="fas fa-spinner fa-spin ml-1"></i> <span data-i18n="loadingDraft">جارٍ صياغة المسودة باستخدام Gemini...</span>
                        </div>
                    </div>
                    
                    <div>
                        <label for="message" class="block text-sm font-medium text-gray-700" data-i18n="formMessageLabel">الرسالة</label>
                        
<textarea id="message" name="message" rows="4" required class="form-input mt-1 block w-full rounded-md shadow-sm p-3 focus:ring-pink-600 focus:border-pink-600"></textarea>
                    </div>

                    
<!-- زر الإرسال -->
<button type="submit" class="cta-button w-full bg-pink-600 hover:bg-pink-700 text-white font-bold py-3 px-4 rounded-lg">
                        <span data-i18n="formSubmitButton">إرسال الرسالة</span>
                    </button>
                </form>
            </div>

            
<!-- معلومات التواصل -->
<div class="mt-12 text-center space-y-4 text-lg text-gray-700">
                
<p><i class="fas fa-envelope text-pink-600 ml-2"></i> <span data-i18n="contactEmail">البريد الإلكتروني:</span> <span class="text-pink-600" dir="ltr">Bayan1325@gmail.com</span></p>
                
<p><i class="fas fa-phone text-pink-600 ml-2"></i> <span data-i18n="contactPhone">الهاتف:</span> <span class="text-pink-600" dir="ltr">+962 7 7236 4081</span></p>
                <div class="flex justify-center space-x-6 space-x-reverse mt-6">
                    
<a href="https://www.facebook.com/profile.php?id=61583046233567" target="_blank" class="text-3xl transition duration-300 social-icon"><i class="fab fa-facebook"></i></a>
                    <a href="https://wa.me/962772364081" target="_blank" class="text-3xl transition duration-300 social-icon"><i class="fab fa-whatsapp"></i></a>
                    <a href="https://www.instagram.com/theadvanalyst_1?igsh=amJqYXNmbThscXIw" target="_blank" class="text-3xl transition duration-300 social-icon"><i class="fab fa-instagram"></i></a>
                </div>
            </div>
            
        </section>

    </main>

    
<!-- التذييل (Footer) -->
<footer class="bg-white border-t border-pink-300/50 py-6 text-center text-gray-500">
        <p><span data-i18n="footerCopy">جميع الحقوق محفوظة &copy;</span> <span id="current-year">2025</span>. <span data-i18n="footerAnalyst">المحلل المصمم.</span></p>
    </footer>

    
<script>
        // Constants for the Gemini API
        const API_KEY = ""; // Kept empty as per instructions
        const API_URL_BASE = "https://generativelanguage.googleapis.com/v1beta/models/";
        const MODEL_NAME = "gemini-2.5-flash-preview-09-2025";
        
        // حالة اللغة الافتراضية
        let currentLang = 'ar';
        
        // قاموس الترجمة
        const translations = {
            'ar': {
                // Meta and Navigation
                'pageTitle': 'المحلل المصمم | مصممة واجهات ويب ومُدخلة بيانات',
                'appTitle': 'المحلل المصمم',
                'navAbout': 'ملخص تعريفي',
                'navSkills': 'المهارات',
                'navContact': 'تواصل',
                'toggleButton': 'English / EN',
                // About Section
                'heroTitle': 'أهلاً بك! أنا المحلل المصمم',
                'heroSubtitle': 'مصممة واجهات ويب ومُدخلة بيانات',
                'summaryP1': 'مصممة واجهات ويب، أقوم بتحويل البيانات المعقدة إلى تجارب مستخدم بسيطة وفعالة، مما يضمن أن تكون النماذج والواجهات ليست فقط جميلة بل دقيقة وسهلة الاستخدام.',
                'summaryP2': 'أركز على بناء واجهات إدخال ديناميكية وسريعة الاستجابة مع تطبيق قواعد تَحَقُّقٍ صارمة من صحة البيانات (Validation) لضمان أعلى مستويات الجودة في المعلومات المدخلة.',
                // Skills Section
                'skillsTitle': 'المهارات التقنية',
                'skillH1': 'تصميم وتطوير الواجهات',
                'skill1_1': 'تصميم واجهات المستخدم وتجربة المستخدم (UI/UX) باستخدام Figma.',
                'skill1_2': 'تطوير الوظائف التفاعلية باستخدام JavaScript ومكتبة React.',
                'skill1_3': 'ضمان التوافق الكامل مع جميع الأجهزة (موبايل، تابلت، حاسوب).',
                'skillH2': 'إدخال ومعالجة البيانات',
                'skill2_1': 'اَلتَّحَقُّقُ من صحة البيانات مُتعدد المستويات (Validation)',
                'skill2_2': 'العمل على قواعد البيانات (SQL/NoSQL)',
                'skill2_3': 'تحليل وتصفية البيانات في Excel/Sheets',
                'skillH3': 'ضمان الجودة والاختبار',
                'skill3_1': 'اختبار قابلية الاستخدام (Usability Testing)',
                'skill3_2': 'التأكد من سلامة وتكامل البيانات (Data Integrity) ',
                'skill3_3': 'تصحيح الأخطاء واستكشاف المشكلات (Debugging)',
                'skill3_4': 'اختبار التوافق عبر المتصفحات والأجهزة (Cross-Browser)',
                // Contact Section
                'contactTitle': 'تواصل معي',
                'formNameLabel': 'الاسم الكامل',
                'formEmailLabel': 'البريد الإلكتروني',
                'formTopicLabel': 'موضوع رسالتك (للمساعدة في الصياغة)',
                'formTopicPlaceholder': 'مثال: تصميم نموذج تسجيل دخول جديد',
                'formDraftButton': 'صياغة تلقائية',
                'formMessageLabel': 'الرسالة',
                'formSubmitButton': 'إرسال الرسالة',
                'contactEmail': 'البريد الإلكتروني:',
                'contactPhone': 'الهاتف:',
                // Footer & Status Messages (AI Drafting)
                'footerCopy': 'جميع الحقوق محفوظة &copy;',
                'footerAnalyst': 'المحلل المصمم.',
                'loadingDraft': 'جارٍ صياغة المسودة باستخدام Gemini...',
                'topicRequired': 'الرجاء إدخال موضوع بسيط للرسالة لمساعدتك في الصياغة.',
                'draftSuccess': 'تمت صياغة الرسالة بنجاح! يمكنك الآن تعديلها وإرسالها.',
                'draftError': 'حدث خطأ في الصياغة التلقائية. تم إدراج نص بديل.',
                'formSubmitSuccess': 'تم استلام رسالتك بنجاح! شكراً لتواصلك.'
            },
            'en': {
                // Meta and Navigation
                'pageTitle': 'The Analyst Designer | Web Interface Designer & Data Entry Specialist',
                'appTitle': 'The Analyst Designer',
                'navAbout': 'About Me',
                'navSkills': 'Skills',
                'navContact': 'Contact',
                'toggleButton': 'العربية / AR',
                // About Section
                'heroTitle': 'Welcome! I am The Analyst Designer',
                'heroSubtitle': 'Web Interface Designer & Data Entry Specialist',
                'summaryP1': 'I am a web interface designer who transforms complex data into simple, effective user experiences, ensuring that forms and interfaces are not only beautiful but also accurate and easy to use.',
                'summaryP2': 'I focus on building dynamic and responsive entry interfaces with the strict application of data validation rules to guarantee the highest quality of input information.',
                // Skills Section
                'skillsTitle': 'Technical Skills',
                'skillH1': 'Interface Design & Development',
                'skill1_1': 'UI/UX design using Figma.',
                'skill1_2': 'Developing interactive functionalities using JavaScript and React library.',
                'skill1_3': 'Ensuring full compatibility with all devices (mobile, tablet, desktop).',
                'skillH2': 'Data Entry & Processing',
                'skill2_1': 'Multi-level data validation.',
                'skill2_2': 'Working with databases (SQL/NoSQL).',
                'skill2_3': 'Data analysis and filtering in Excel/Sheets.',
                'skillH3': 'Quality Assurance & Testing',
                'skill3_1': 'Usability Testing.',
                'skill3_2': 'Ensuring Data Integrity.',
                'skill3_3': 'Debugging and Troubleshooting.',
                'skill3_4': 'Cross-Browser and device compatibility testing.',
                // Contact Section
                'contactTitle': 'Contact Me',
                'formNameLabel': 'Full Name',
                'formEmailLabel': 'Email Address',
                'formTopicLabel': 'Message Topic (for drafting assistance)',
                'formTopicPlaceholder': 'Example: Designing a new login form',
                'formDraftButton': 'AI Draft',
                'formMessageLabel': 'Message',
                'formSubmitButton': 'Send Message',
                'contactEmail': 'Email:',
                'contactPhone': 'Phone:',
                // Footer & Status Messages (AI Drafting)
                'footerCopy': 'All rights reserved &copy;',
                'footerAnalyst': 'The Analyst Designer.',
                'loadingDraft': 'Drafting message using Gemini...',
                'topicRequired': 'Please enter a brief message topic to help with drafting.',
                'draftSuccess': 'Message successfully drafted! You can now edit and send it.',
                'draftError': 'Automatic drafting failed. Placeholder text inserted.',
                'formSubmitSuccess': 'Your message has been received successfully! Thank you for contacting us.'
            }
        };

        /**
         * وظيفة مساعدة لإجراء طلبات جلب مع تراجع أسي (Exponential Backoff).
         */
        async function exponentialBackoffFetch(url, options, retries = 5, delay = 1000) {
            for (let i = 0; i < retries; i++) {
                try {
                    const response = await fetch(url, options);
                    if (!response.ok) {
                        if (response.status === 429 && i < retries - 1) { // Rate limit
                            await new Promise(resolve => setTimeout(resolve, delay));
                            delay *= 2; // Exponential backoff
                            continue;
                        }
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }
                    return response;
                } catch (error) {
                    if (i === retries - 1) {
                        console.error("Fetch failed after multiple retries:", error);
                        throw error;
                    }
                    await new Promise(resolve => setTimeout(resolve, delay));
                    delay *= 2;
                }
            }
        }
        
        /**
         * وظيفة لتطبيق الترجمة على جميع العناصر في الصفحة.
         */
        function applyTranslation(lang) {
            // تحديث سمة اللغة واتجاه الصفحة
            document.documentElement.lang = lang;
            document.documentElement.dir = (lang === 'ar') ? 'rtl' : 'ltr';

            // تعديل تنسيق flex لأزرار التواصل الاجتماعي بناءً على الاتجاه
            const socialContainer = document.querySelector('#contact .flex');
            if (socialContainer) {
                // Tailwind classes for direction/reversal
                if (lang === 'ar') {
                    socialContainer.classList.add('space-x-reverse');
                } else {
                    socialContainer.classList.remove('space-x-reverse');
                }
            }
            
            // تحديث جميع النصوص بناءً على سمة data-i18n
            document.querySelectorAll('[data-i18n]').forEach(element => {
                const key = element.getAttribute('data-i18n');
                if (translations[lang] && translations[lang][key]) {
                    element.textContent = translations[lang][key];
                }
            });

            // تحديث الأوصاف (Placeholders)
            document.querySelectorAll('[data-i18n-placeholder]').forEach(element => {
                const key = element.getAttribute('data-i18n-placeholder');
                if (translations[lang] && translations[lang][key]) {
                    element.placeholder = translations[lang][key];
                }
            });

            // تحديث زر تبديل اللغة
            const toggleButton = document.getElementById('lang-toggle');
            if (toggleButton) {
                toggleButton.textContent = translations[lang].toggleButton;
            }
            
            // تحديث العنوان الرئيسي للصفحة
            document.title = translations[lang].pageTitle;
        }

        /**
         * وظيفة لتبديل اللغة وتطبيق الترجمة.
         */
        function toggleLanguage() {
            currentLang = (currentLang === 'ar') ? 'en' : 'ar';
            localStorage.setItem('userLang', currentLang);
            applyTranslation(currentLang);
        }

        /**
         * وظيفة صياغة الرسالة باستخدام Gemini API.
         * ملاحظة: يتم إرسال التعليمات والاستفسار إلى Gemini باللغة العربية للحصول على أفضل نتيجة، ويتم ترجمة رسائل الحالة فقط.
         */
        async function draftMessageWithGemini() {
            const topicInput = document.getElementById('message-topic');
            const messageTextarea = document.getElementById('message');
            const loadingIndicator = document.getElementById('ai-loading');
            const draftButton = document.getElementById('ai-draft-button');

            const userTopic = topicInput.value.trim();
            
            // وظيفة داخلية لعرض الحالة بترجمة
            const showStatus = (key, isError = false) => {
                const message = translations[currentLang][key];
                // تم تعديل الألوان لاستخدام Pink 600
                const colorClass = isError ? 'text-red-600' : 'text-pink-600';
                loadingIndicator.innerHTML = `<i class="fas ${isError ? 'fa-exclamation-triangle' : 'fa-info-circle'} ml-1"></i> ${message}`;
                loadingIndicator.classList.remove('hidden', 'text-red-600', 'text-gray-800', 'text-fuchsia-600'); // إزالة فوشيا
                loadingIndicator.classList.add(colorClass);
                
                if (!isError) {
                    setTimeout(() => loadingIndicator.classList.add('hidden'), 5000); 
                }
            };
            
            if (!userTopic) {
                showStatus('topicRequired', true);
                return;
            }

            showStatus('loadingDraft');
            draftButton.disabled = true;
            messageTextarea.value = ''; // مسح الرسالة السابقة
            
            // تعليمات النظام والطلب باللغة العربية (لتحسين جودة الصياغة المهنية العربية)
            const systemPrompt = `أنت مساعد احترافي لصياغة رسائل البريد الإلكتروني. مهمتك هي كتابة رسالة استفسار مهذبة واحترافية باللغة العربية موجهة إلى مصمم واجهات ويب/مختص في إدخال ومعالجة البيانات ("المحلل المصمم"). يجب أن تكون الرسالة موجزة ومركزة على الموضوع الذي يقدمه المستخدم. اختم الرسالة بعبارة مهذبة (مثل: مع خالص التقدير،) وترك مساحة لاسم المرسل.`;

            const userQuery = `صغّر مسودة رسالة احترافية بناءً على الموضوع التالي: "${userTopic}".`;
            
            const payload = {
                contents: [{ parts: [{ text: userQuery }] }],
                systemInstruction: {
                    parts: [{ text: systemPrompt }]
                },
            };
            
            const apiUrl = `${API_URL_BASE}${MODEL_NAME}:generateContent?key=${API_KEY}`;
            const options = {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(payload)
            };

            try {
                const response = await exponentialBackoffFetch(apiUrl, options);
                const result = await response.json();
                
                const generatedText = result.candidates?.[0]?.content?.parts?.[0]?.text;

                if (generatedText) {
                    messageTextarea.value = generatedText;
                    showStatus('draftSuccess', false);
                } else {
                    throw new Error("API failed to draft message.");
                }
            } catch (error) {
                console.error("Gemini API Error:", error);
                
                // رسالة بديلة باللغة العربية
                const fallbackDraft = `عزيزي المحلل المصمم،\n\nأرجو أن تكون بخير.\n\nأود الاستفسار بخصوص: "${userTopic}".\n\nأرجو التواصل معي لمناقشة التفاصيل.\n\nمع خالص التقدير،\n[اسمك]`;
                messageTextarea.value = fallbackDraft;
                
                showStatus('draftError', true);
            } finally {
                draftButton.disabled = false;
            }
        }
        
        // =================================== //
        // وظائف التنقل (Navigation Functions) //
        // =================================== //

        function showSection(sectionId) {
            const sections = document.querySelectorAll('section');
            const navLinks = document.querySelectorAll('.nav-link');
            
            sections.forEach(section => {
                // إظهار القسم المطلوب وإخفاء البقية
                if (section.id === sectionId) {
                    section.classList.remove('hidden');
                } else {
                    section.classList.add('hidden');
                }
            });

            // تحديث حالة الرابط النشط في شريط التنقل
            navLinks.forEach(link => {
                link.classList.remove('active-link');
                // تغيير لون الخلفية عند التمرير
                link.classList.add('hover:bg-pink-100'); 

                if (link.getAttribute('href') === '#' + sectionId) {
                    link.classList.add('active-link');
                    link.classList.remove('hover:bg-pink-100');
                }
            });
            
            // تحديث الـ URL دون إعادة تحميل الصفحة
            history.pushState(null, null, '#' + sectionId);
        }

        document.addEventListener('DOMContentLoaded', () => {
            const langToggleButton = document.getElementById('lang-toggle');
            const navLinks = document.querySelectorAll('.nav-link');
            const contactForm = document.getElementById('contact-form');
            const aiDraftButton = document.getElementById('ai-draft-button'); 
            
            // 0. تهيئة اللغة: المحاولة لاسترداد اللغة المحفوظة، وإلا الافتراضية 'ar'
            const storedLang = localStorage.getItem('userLang');
            currentLang = (storedLang && translations[storedLang]) ? storedLang : 'ar';
            applyTranslation(currentLang);
            
            // 4. تحديث السنة تلقائياً في التذييل
            const currentYearSpan = document.getElementById('current-year');
            if (currentYearSpan) {
                const currentYear = new Date().getFullYear();
                currentYearSpan.textContent = currentYear;
            }

            // 1. تحديد القسم الأولي النشط عند تحميل الصفحة
            const initialSection = window.location.hash.substring(1) || 'about';
            showSection(initialSection);

            // 2. تفعيل التفاعل مع روابط التنقل
            navLinks.forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    const sectionId = link.getAttribute('href').substring(1);
                    showSection(sectionId);
                });
            });

            // 3. معالجة نموذج الاتصال (لأغراض العرض فقط)
            if (contactForm) {
                contactForm.addEventListener('submit', (e) => {
                    e.preventDefault();
                    
                    const loadingIndicator = document.getElementById('ai-loading');
                    // عرض رسالة النجاح باللغة الحالية
                    const successMessage = translations[currentLang]['formSubmitSuccess'];
                    
                    // استخدام pink-600
                    const colorClass = 'text-pink-600';
                    loadingIndicator.innerHTML = `<i class="fas fa-check-circle ml-1"></i> ${successMessage}`;
                    loadingIndicator.classList.remove('hidden', 'text-red-600', 'text-gray-800');
                    loadingIndicator.classList.add(colorClass);
                    
                    // إخفاء الرسالة بعد 5 ثوانٍ
                    setTimeout(() => {
                        loadingIndicator.classList.add('hidden');
                    }, 5000);
                    
                    contactForm.reset();
                });
            }

            // 5. تفعيل زر الصياغة التلقائية
            if (aiDraftButton) {
                aiDraftButton.addEventListener('click', draftMessageWithGemini);
            }
            
            // 6. تفعيل زر تبديل اللغة
            if (langToggleButton) {
                langToggleButton.addEventListener('click', toggleLanguage);
            }
        });
    </script>
</body>
</html>